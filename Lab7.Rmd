---
title: "Lab7"
author: "Anna Matarazzo"
date: "10/23/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r}
binom.test(x=65, n=100, p=0.5, alternative = "greater")
```



```{r}
test_results <- binom.test(x=65, n=100, p=0.5, alternative = "greater")

test_results$p.value

```

Pigeon A was `r test_results$statistic`% correct (p<=`r test_results$p.value`).



```{r}

library(ggplot2)
qplot(y=dbinom(0:100, 100, .5))+
  geom_bar(stat='identity', position="dodge")+
  ylab('density')+
  xlab('#of successes')

sum(dbinom(0:100, 100, .5))

sum(dbinom(65:100, 100, .5))



```



```{r}
binom.test(x=7, n=10, alternative = "greater")

```


```{r}
coin_flips <- data.frame (number_of_heads = 0:10,
                          probability = dbinom(x=0:10, size=10, prob=.5),
                          cumulative=pbinom(0:10, size=10,prob=.5),
                          rev_cumulative = pbinom(-1:9,10,.5, lower.tail = FALSE))

knitr::kable(coin_flips)

```


```{r}
task_designs <- data.frame (number_of_heads = 0:1,
                          probability = dbinom(x=0:1, size=1, prob=.5),
                          cumulative=pbinom(0:1, size=1,prob=.5),
                          rev_cumulative = pbinom(-1:0,1,.5, lower.tail = FALSE))

knitr::kable(task_designs)

```


```{r}
task_designs <- data.frame (number_of_heads = 0:2,
                          probability = dbinom(x=0:2, size=2, prob=.5),
                          cumulative=pbinom(0:2, size=2,prob=.5),
                          rev_cumulative = pbinom(-1:1,1,.5, lower.tail = FALSE))

knitr::kable(task_designs)

```

```{r}
task_designs <- data.frame (number_of_heads = 0:2,
                          probability = dbinom(x=0:2, size=2, prob=.5),
                          cumulative=pbinom(0:2, size=2,prob=.5),
                          rev_cumulative = pbinom(-1:1,1,.5, lower.tail = FALSE))

knitr::kable(task_designs)

```

```{r}
task_designs <- data.frame (number_of_heads = 0:3,
                          probability = dbinom(x=0:3, size=3, prob=.5),
                          cumulative=pbinom(0:3, size=3,prob=.5),
                          rev_cumulative = pbinom(-1:2,3,.5, lower.tail = FALSE))

knitr::kable(task_designs)

```

```{r}
binom.test(x=51, n=100, .5, alternative = "greater")

```

```{r}
binom.test(x=5100, n=10000, .5, alternative = "greater")

```


## Problem 1

1. A test-taker answered 50 true/false questions and received a score of 60% correct. Report the results of a binomial test and explain whether you think the test-score could be produced by the test-taker randomly guessing on each question. (2 points)


```{r}

binom_test1 <- binom.test(x=50*0.6, n=50, .5, alternative = "greater")

binom_test1 

p_value <- format(round(binom_test1$p.value, 4), nsmall = 2)
p_value_percent <- format(round(binom_test1$p.value*100, 2), nsmall = 2)

```

A test-taker answered `r binom_test1$statistic` questions correctly with a p value <=`r p_value`. Which means there is a `r p_value_percent`% chance that she would get the same result if she guessed the answers. This result is not statistically significant if we take the commonly accepted level of significance of p=0.05, which means that the result was unlikely to happen due to chance. Still I would not bet my collection of old payphone cards on that she didn't guess the answers because `r p_value` is still a good chance.

` Confidence level - 99 `



```{r}
# adding color to a critical region

library(ggplot2)
library(dplyr)

sample_means <- replicate(10000, mean(rnorm(25,10,20)))

plot_df <- data.frame(sample = 1:10000,
                      means = sample_means) %>%
  mutate(colors = means >= 12)

ggplot(plot_df, aes(x=means))+
  geom_histogram(binwidth=.5, aes(color=colors))+
  geom_vline(xintercept=12, color="red")+
  theme_classic()

```



```{r}
# define coordinate vectors for vertices of the polygon
x <- c(2, seq(2, 10, 0.01), 10)
y <- c(0, df(seq(2, 10, 0.01), 3, 14), 0)

# draw density of F_{3, 14}
curve(df(x ,3 ,14), 
      ylim = c(0, 0.8), 
      xlim = c(0, 10), 
      ylab = "Density",
      main = "Density Function")

# draw the polygon
polygon(x, y, col = "orange")

```


## Problem 2

An examiner wants to make a TRUE/FALSE test, but is still deciding how many questions they will include. They want to make sure that it would be very difficult to simply randomly guess and be able to score any higher than 55% percent. How many questions would the examiner need to use to be confident that scores of 55% or higher were not produced by chance? (2 points)


```{r}

n <- c(seq(350, 450, 5)) # number of questions
x <- c()  # 55 percent from n
for(i in 1:length(n)){
  x[i] <- 0.55*n[i]
  as.integer(x[i])
  }
p <- 0.5 #probability of guessing correctly 

successes <- as.integer(x)

binom.test.p.values <- NULL
for (i in 1:length(n)){
 binom.test.p.values <- append(binom.test.p.values, binom.test(successes[i], n[i], p)$p.value)
}

dat <- data.frame (n, 
                   x,
                   binom.test.p.values)
dat


ggplot(dat, aes(binom.test.p.values, 
                n,
               group = 1))+
  geom_point()+
  geom_line(col=ifelse(binom.test.p.values<=0.05, "black", "red"))


```



a <- sample(x = 0:9, size = 7, replace = FALSE)
samples <- replicate(100000, sample(a))

count_example <- 0
for(i in 1:100000){
  if(sum (samples[,i] == c(8,6,7,5,3,0,9)) == 7) {
    count_example <-  count_example+1
  }
}

count_example
count_example/100000 








































